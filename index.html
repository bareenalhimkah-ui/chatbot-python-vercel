<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mein Chatbot (Python + Vercel)</title>
    <style>
      :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
      body { margin: 0; background: #0b0f19; color: #e6e6e6; }
      .wrap { max-width: 780px; margin: 0 auto; padding: 24px; }
      .card { background: #11162a; border: 1px solid #1c2442; border-radius: 16px; padding: 20px; }
      h1 { margin: 0 0 12px; font-size: 22px; }
      #log { height: 420px; overflow: auto; padding: 12px; background: #0e1326; border-radius: 12px; border: 1px solid #1a2142;}
      .msg { margin: 8px 0; line-height: 1.45 }
      .user { color: #a5d6ff }
      .bot { color: #dfe6ff }
      form { display: flex; gap: 8px; margin-top: 12px; }
      input, button { font-size: 16px; }
      input { flex: 1; padding: 12px; border-radius: 12px; border: 1px solid #334; background: #0e1326; color: #e6e6e6;}
      button { padding: 12px 16px; border: 1px solid #2b7; background: #0c2; color: #031; border-radius: 12px; cursor: pointer;}
      button:disabled { opacity: .6; cursor: not-allowed; }
      .note { font-size: 12px; color: #9fb3c8; margin-top: 8px;}
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="card">
        <h1>Chatbot</h1>
        <div id="log" aria-live="polite"></div>
        <form id="form">
          <input id="input" placeholder="Frag mich etwas …" autocomplete="off" />
          <button id="send">Senden</button>
        </form>
        <div class="note">Hinweis: Die Anfragen laufen über <code>/api/chat</code> (Python-Serverless Function auf Vercel).</div>
      </div>
    </div>
    <script>
      const log = document.getElementById('log');
      const form = document.getElementById('form');
      const input = document.getElementById('input');
      const sendBtn = document.getElementById('send');

      function addLine(text, cls) {
        const p = document.createElement('div');
        p.className = 'msg ' + cls;
        p.textContent = text;
        log.appendChild(p);
        log.scrollTop = log.scrollHeight;
      }

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const msg = input.value.trim();
        if (!msg) return;
        addLine('Du: ' + msg, 'user');
        input.value = '';
        input.focus();
        sendBtn.disabled = true;
        try {
          const res = await fetch('/api/chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ message: msg })
          });
          if (!res.ok) {
            const txt = await res.text();
            addLine('Fehler: ' + txt, 'bot');
          } else {
            const data = await res.json();
            addLine('Bot: ' + (data.reply || '(keine Antwort)'), 'bot');
          }
        } catch (err) {
          addLine('Netzwerkfehler: ' + err.message, 'bot');
        } finally {
          sendBtn.disabled = false;
        }
      });
    </script>
  </body>
</html>
